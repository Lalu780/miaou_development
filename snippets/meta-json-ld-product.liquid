<!-- Product -->
{% for variant in product.variants %}

{% if variant.available %}
  {% assign json_ld_availability = 'http://schema.org/InStock' %}
{% else %}
  {% assign json_ld_availability = 'http://schema.org/OutOfStock' %}
{% endif %}

{% if variant.image.src and variant.image.src != blank %}
  {% assign json_ld_image = variant.image.src %}
{% else %}
  {% assign json_ld_image = product.featured_image.src %}
{% endif %}

<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@type": "Product",
  "name": {{ product.title | append: ' — ' | append: variant.title | json }},
  "image": {{ json_ld_image | img_url: '1024x1024' | prepend: 'https:' | json }},
  "description": {{ product.description | strip_html | strip | json }},
  "sku": {{ variant.sku | json }},
  "offers":{
    "@type": "Offer",
    "priceCurrency": {{ shop.currency | json }},
    "price": {{ variant.price | money_without_currency | json }},
    "availability": {{ json_ld_availability | json }},
    "url": {{ variant.url | prepend: shop.url | json }},
    "seller":{
      "@type": "Organization",
      "name": {{ shop.name | json }}
    }
  },
  "brand":{
    "@type": "Thing",
    "name": {{ product.vendor | json }}
  }
}
</script>

{% endfor %}

<!-- Product Breadcrumbs -->
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement":
  [
    {
      "@type": "ListItem",
      "position": 1,
      "item":
      {
        "@id": {{ shop.url | json }},
        "name": "Home"
      }
    },
    {
      "@type": "ListItem",
      "position": 2,
      "item":
      {
        "@id": {{ product.selected_or_first_available_variant.url | prepend: shop.url | json }},
        "name": {{ product.title | append: ' — ' | append: product.selected_or_first_available_variant.title | json }}
      }
    }
  ]
}
</script>
